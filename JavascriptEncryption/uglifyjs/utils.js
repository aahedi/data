"use strict";function array_to_hash(n){for(var r=Object.create(null),t=0;t<n.length;++t)r[n[t]]=!0;return r}function slice(n,r){return Array.prototype.slice.call(n,r||0)}function characters(n){return n.split("")}function member(n,r){for(var t=r.length;--t>=0;)if(r[t]==n)return!0;return!1}function find_if(n,r){for(var t=0,e=r.length;e>t;++t)if(n(r[t]))return r[t]}function repeat_string(n,r){if(0>=r)return"";if(1==r)return n;var t=repeat_string(n,r>>1);return t+=t,1&r&&(t+=n),t}function DefaultsError(n,r){Error.call(this,n),this.msg=n,this.defs=r}function defaults(n,r,t){n===!0&&(n={});var e=n||{};if(t)for(var o in e)e.hasOwnProperty(o)&&!r.hasOwnProperty(o)&&DefaultsError.croak("`"+o+"` is not a supported option",r);for(var o in r)r.hasOwnProperty(o)&&(e[o]=n&&n.hasOwnProperty(o)?n[o]:r[o]);return e}function merge(n,r){for(var t in r)r.hasOwnProperty(t)&&(n[t]=r[t]);return n}function noop(){}function push_uniq(n,r){n.indexOf(r)<0&&n.push(r)}function string_template(n,r){return n.replace(/\{(.+?)\}/g,function(n,t){return r[t]})}function remove(n,r){for(var t=n.length;--t>=0;)n[t]===r&&n.splice(t,1)}function mergeSort(n,r){function t(n,t){for(var e=[],o=0,i=0,s=0;o<n.length&&i<t.length;)e[s++]=r(n[o],t[i])>0?t[i++]:n[o++];return o<n.length&&e.push.apply(e,n.slice(o)),i<t.length&&e.push.apply(e,t.slice(i)),e}function e(n){if(n.length<=1)return n;var r=Math.floor(n.length/2),o=n.slice(0,r),i=n.slice(r);return o=e(o),i=e(i),t(o,i)}return n.length<2?n.slice():e(n)}function set_difference(n,r){return n.filter(function(n){return r.indexOf(n)<0})}function set_intersection(n,r){return n.filter(function(n){return r.indexOf(n)>=0})}function makePredicate(n){function r(n){if(1==n.length)return t+="return str === "+JSON.stringify(n[0])+";";t+="switch(str){";for(var r=0;r<n.length;++r)t+="case "+JSON.stringify(n[r])+":";t+="return true}return false;"}n instanceof Array||(n=n.split(" "));var t="",e=[];n:for(var o=0;o<n.length;++o){for(var i=0;i<e.length;++i)if(e[i][0].length==n[o].length){e[i].push(n[o]);continue n}e.push([n[o]])}if(e.length>3){e.sort(function(n,r){return r.length-n.length}),t+="switch(str.length){";for(var o=0;o<e.length;++o){var s=e[o];t+="case "+s[0].length+":",r(s)}t+="}"}else r(n);return Function("str",t)}function all(n,r){for(var t=n.length;--t>=0;)if(!r(n[t]))return!1;return!0}function Dictionary(){this._values=Object.create(null),this._size=0}DefaultsError.prototype=Object.create(Error.prototype),DefaultsError.prototype.constructor=DefaultsError,DefaultsError.croak=function(n,r){throw new DefaultsError(n,r)};var MAP=function(){function n(n,i,s){function a(){var a=i(n[f],f),l=a instanceof e;return l&&(a=a.v),a instanceof r?(a=a.v,a instanceof t?c.push.apply(c,s?a.v.slice().reverse():a.v):c.push(a)):a!==o&&(a instanceof t?u.push.apply(u,s?a.v.slice().reverse():a.v):u.push(a)),l}var f,u=[],c=[];if(n instanceof Array)if(s){for(f=n.length;--f>=0&&!a(););u.reverse(),c.reverse()}else for(f=0;f<n.length&&!a();++f);else for(f in n)if(n.hasOwnProperty(f)&&a())break;return c.concat(u)}function r(n){this.v=n}function t(n){this.v=n}function e(n){this.v=n}n.at_top=function(n){return new r(n)},n.splice=function(n){return new t(n)},n.last=function(n){return new e(n)};var o=n.skip={};return n}();Dictionary.prototype={set:function(n,r){return this.has(n)||++this._size,this._values["$"+n]=r,this},add:function(n,r){return this.has(n)?this.get(n).push(r):this.set(n,[r]),this},get:function(n){return this._values["$"+n]},del:function(n){return this.has(n)&&(--this._size,delete this._values["$"+n]),this},has:function(n){return"$"+n in this._values},each:function(n){for(var r in this._values)n(this._values[r],r.substr(1))},size:function(){return this._size},map:function(n){var r=[];for(var t in this._values)r.push(n(this._values[t],t.substr(1)));return r}};